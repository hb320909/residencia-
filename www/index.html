<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Residencia Escolar Portal</title>
    
    <base href="/" />
    
    <meta name="color-scheme" content="light dark" />
    <meta
      name="viewport"
      content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    
    <link rel="manifest" href="/manifest.json" />
    
    <meta name="theme-color" content="#6366f1" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Residencia Escolar" />
    
    <link rel="apple-touch-icon" href="/icon-192.png" />
    
    <link rel="stylesheet" href="/styles.css" />
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts for better typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
      <div class="login-card">
        <h2 class="login-title">Iniciar Sesi√≥n</h2>
        <form id="loginForm" class="login-form">
          <div class="form-group">
            <label for="username" class="form-label">Usuario:</label>
            <input type="text" id="username" name="username" required class="form-input">
          </div>
          <div class="form-group">
            <label for="password" class="form-label">Contrase√±a:</label>
            <input type="password" id="password" name="password" required class="form-input">
          </div>
          <div id="loginError" class="text-danger text-center mb-3 hidden">Usuario o contrase√±a incorrectos</div>
          <button type="submit" class="btn btn-primary btn-full">
            <i class="fas fa-sign-in-alt"></i>
            Iniciar Sesi√≥n
          </button>
        </form>
      </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden">
      <!-- Header -->
      <header class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4">
        <div class="container mx-auto flex justify-between items-center">
          <h1 class="text-xl font-bold flex items-center gap-2">
            <i class="fas fa-school"></i>
            Residencia Escolar Portal
          </h1>
          <button id="logoutBtn" class="btn btn-danger">
            <i class="fas fa-sign-out-alt"></i>
            Cerrar Sesi√≥n
          </button>
        </div>
      </header>

      <!-- Navigation -->
      <nav class="bg-white shadow-sm border-b">
        <div class="container mx-auto px-4 py-3">
          <div class="nav-links hidden md:flex space-x-1">
            <a href="#" class="nav-link" data-section="dashboard">
              <i class="fas fa-tachometer-alt"></i>
              Dashboard
            </a>
            <a href="#" class="nav-link" data-section="students">
              <i class="fas fa-users"></i>
              Alumnos
            </a>
            <a href="#" class="nav-link" data-section="rooms">
              <i class="fas fa-bed"></i>
              Habitaciones
            </a>
            <a href="#" class="nav-link" data-section="absences">
              <i class="fas fa-calendar-times"></i>
              Faltas
            </a>
            <a href="#" class="nav-link" data-section="reports">
              <i class="fas fa-exclamation-triangle"></i>
              Partes
            </a>
            <a href="#" class="nav-link" data-section="seguimiento">
              <i class="fas fa-chart-line"></i>
              Seguimiento
            </a>
            <a href="#" class="nav-link" data-section="agenda">
              <i class="fas fa-calendar-alt"></i>
              Agenda
            </a>
          </div>
          <select id="mobileNav" class="md:hidden w-full p-2 border rounded">
            <option value="dashboard">üìä Dashboard</option>
            <option value="students">üë• Alumnos</option>
            <option value="rooms">üõèÔ∏è Habitaciones</option>
            <option value="absences">üìÖ Faltas</option>
            <option value="reports">‚ö†Ô∏è Partes</option>
            <option value="seguimiento">üìà Seguimiento</option>
            <option value="agenda">üìÜ Agenda</option>
          </select>
        </div>
      </nav>

      <!-- Content Sections -->
      <main class="container mx-auto p-4">
        <!-- Dashboard -->
        <section id="dashboard" class="content-section p-6">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <i class="fas fa-tachometer-alt text-primary"></i>
            Dashboard
          </h2>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="stat-card">
              <h3>Total Alumnos</h3>
              <p id="totalAlumnos">0</p>
            </div>
            <div class="stat-card">
              <h3>Habitaciones Ocupadas</h3>
              <p id="habitacionesOcupadas">0</p>
            </div>
            <div class="stat-card">
              <h3>Total Faltas</h3>
              <p id="totalFaltas">0</p>
            </div>
          </div>
          <div class="card">
            <h3 class="text-lg font-semibold mb-4 flex items-center gap-2">
              <i class="fas fa-history text-primary"></i>
              Actividad Reciente
            </h3>
            <div id="actividadReciente" class="space-y-3">
              <div class="activity-item">
                <i class="fas fa-info-circle"></i>
                <div class="content">
                  <p class="text-sm">Sistema inicializado correctamente</p>
                  <span class="time">Ahora</span>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Students -->
        <section id="students" class="content-section hidden p-6">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <i class="fas fa-users text-primary"></i>
            Gesti√≥n de Alumnos
          </h2>
          <div class="card mb-6">
            <h3 class="text-lg font-semibold mb-4 flex items-center gap-2">
              <i class="fas fa-plus text-success"></i>
              A√±adir Alumno
            </h3>
            <form id="addStudentForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="form-group">
                <label class="form-label">Nombre</label>
                <input type="text" id="studentNombre" placeholder="Nombre completo" required class="form-input">
              </div>
              <div class="form-group">
                <label class="form-label">Fecha de Nacimiento</label>
                <input type="date" id="studentNacimiento" required class="form-input">
              </div>
              <div class="form-group">
                <label class="form-label">G√©nero</label>
                <select id="studentGenero" required class="form-select">
                  <option value="">Seleccionar g√©nero</option>
                  <option value="hombre">Hombre</option>
                  <option value="mujer">Mujer</option>
                  <option value="otro">Otro</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Curso</label>
                <input type="text" id="studentCurso" placeholder="Ej: 1¬∫ ESO" required class="form-input">
              </div>
              <div class="form-group">
                <label class="form-label">Tel√©fono 1</label>
                <input type="tel" id="studentTelefono1" placeholder="Tel√©fono principal" required class="form-input">
              </div>
              <div class="form-group">
                <label class="form-label">Tel√©fono 2</label>
                <input type="tel" id="studentTelefono2" placeholder="Tel√©fono secundario" class="form-input">
              </div>
              <div class="form-group md:col-span-2">
                <label class="flex items-center gap-2">
                  <input type="checkbox" id="studentMayor16" class="form-input w-auto">
                  <span>Mayor de 16 a√±os</span>
                </label>
              </div>
              <div class="md:col-span-2">
                <button type="submit" class="btn btn-primary btn-full">
                  <i class="fas fa-save"></i>
                  A√±adir Alumno
                </button>
              </div>
            </form>
          </div>
          <div class="card">
            <h3 class="text-lg font-semibold mb-4 flex items-center gap-2">
              <i class="fas fa-list text-primary"></i>
              Lista de Alumnos
            </h3>
            <div class="overflow-x-auto">
              <table class="table">
                <thead>
                  <tr>
                    <th>Nombre</th>
                    <th>Edad</th>
                    <th>G√©nero</th>
                    <th>Habitaci√≥n</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody id="studentsTableBody"></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- Rooms -->
        <section id="rooms" class="content-section hidden p-6">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <i class="fas fa-bed text-primary"></i>
            Gesti√≥n de Habitaciones
          </h2>
          <div class="card mb-6">
            <h3 class="text-lg font-semibold mb-4 flex items-center gap-2">
              <i class="fas fa-user-plus text-success"></i>
              Asignar Habitaci√≥n
            </h3>
            <form id="assignRoomForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div class="form-group">
                <label class="form-label">Alumno</label>
                <select id="roomStudent" required class="form-select">
                  <option value="">Seleccionar Alumno</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Habitaci√≥n</label>
                <select id="roomNumber" required class="form-select">
                  <option value="">Seleccionar Habitaci√≥n</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Cama</label>
                <select id="roomBed" class="form-select">
                  <option value="">Seleccionar Cama</option>
                </select>
              </div>
              <div class="md:col-span-3">
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-check"></i>
                  Asignar
                </button>
              </div>
            </form>
          </div>
          <div id="roomsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
        </section>

        <!-- Absences -->
        <section id="absences" class="content-section hidden p-6">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <i class="fas fa-calendar-times text-primary"></i>
            Gesti√≥n de Faltas
          </h2>
          <div class="card mb-6">
            <h3 class="text-lg font-semibold mb-4 flex items-center gap-2">
              <i class="fas fa-plus text-success"></i>
              Registrar Falta
            </h3>
            <form id="addAbsenceForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div class="form-group">
                <label class="form-label">Alumno</label>
                <select id="absenceStudent" required class="form-select">
                  <option value="">Seleccionar Alumno</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Fecha</label>
                <input type="date" id="absenceDate" required class="form-input">
              </div>
              <div class="form-group">
                <label class="form-label">Descripci√≥n</label>
                <input type="text" id="absenceDescription" placeholder="Motivo de la falta" required class="form-input">
              </div>
              <div class="md:col-span-3">
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-save"></i>
                  Registrar Falta
                </button>
              </div>
            </form>
          </div>
          <div class="card mb-6">
            <h3 class="text-lg font-semibold mb-4 flex items-center gap-2">
              <i class="fas fa-filter text-primary"></i>
              Filtros
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div class="form-group">
                <label class="form-label">Alumno</label>
                <select id="filterStudent" class="form-select">
                  <option value="">Todos los alumnos</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Fecha</label>
                <input type="date" id="filterDate" class="form-input">
              </div>
              <div class="form-group">
                <button id="clearFilters" class="btn btn-secondary btn-full">
                  <i class="fas fa-times"></i>
                  Limpiar Filtros
                </button>
              </div>
            </div>
          </div>
          <div class="card">
            <h3 class="text-lg font-semibold mb-4 flex items-center gap-2">
              <i class="fas fa-list text-primary"></i>
              Lista de Faltas
            </h3>
            <div class="overflow-x-auto">
              <table class="table">
                <thead>
                  <tr>
                    <th>Alumno</th>
                    <th>Fecha</th>
                    <th>Descripci√≥n</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody id="absencesTableBody"></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- Reports -->
        <section id="reports" class="content-section hidden">
          <h2 class="text-2xl font-bold mb-4">Gesti√≥n de Partes</h2>
          <div class="bg-white p-4 rounded-lg shadow mb-6">
            <h3 class="text-lg font-semibold mb-4">Registrar Parte</h3>
            <form id="addReportForm">
              <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <select id="reportStudent" required class="border p-2 rounded">
                  <option value="">Seleccionar Alumno</option>
                </select>
                <input type="date" id="reportDate" required class="border p-2 rounded">
                <select id="reportType" required class="border p-2 rounded">
                  <option value="">Tipo</option>
                  <option value="disciplinario">Disciplinario</option>
                  <option value="academico">Acad√©mico</option>
                  <option value="otro">Otro</option>
                </select>
                <input type="text" id="reportDescription" placeholder="Descripci√≥n" required class="border p-2 rounded">
              </div>
              <button type="submit" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded">Registrar Parte</button>
            </form>
          </div>
          <div class="bg-white p-4 rounded-lg shadow">
            <h3 class="text-lg font-semibold mb-4">Lista de Partes</h3>
            <table class="w-full">
              <thead>
                <tr>
                  <th class="text-left">Alumno</th>
                  <th class="text-left">Fecha</th>
                  <th class="text-left">Tipo</th>
                  <th class="text-left">Descripci√≥n</th>
                  <th class="text-left">Acciones</th>
                </tr>
              </thead>
              <tbody id="reportsTableBody"></tbody>
            </table>
          </div>
        </section>

        <!-- Seguimiento -->
        <section id="seguimiento" class="content-section hidden">
          <h2 class="text-2xl font-bold mb-4">Seguimiento Acad√©mico</h2>
          <div class="bg-white p-4 rounded-lg shadow mb-6">
            <h3 class="text-lg font-semibold mb-4">A√±adir Seguimiento</h3>
            <form id="addSeguimientoForm">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <select id="seguimientoStudent" required class="border p-2 rounded">
                  <option value="">Seleccionar Alumno</option>
                </select>
                <input type="date" id="seguimientoDate" required class="border p-2 rounded">
              </div>
              <div class="mt-4">
                <textarea id="seguimientoNotes" placeholder="Notas del seguimiento" rows="4" class="w-full border p-2 rounded"></textarea>
              </div>
              <button type="submit" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded">A√±adir Seguimiento</button>
            </form>
          </div>
          <div class="bg-white p-4 rounded-lg shadow">
            <h3 class="text-lg font-semibold mb-4">Resumen del Alumno</h3>
            <select id="alumnoResumenSelect" class="border p-2 rounded mb-4">
              <option value="">Seleccionar Alumno</option>
            </select>
            <div id="alumnoResumen"></div>
          </div>
        </section>

        <!-- Agenda -->
        <section id="agenda" class="content-section hidden">
          <h2 class="text-2xl font-bold mb-4">Agenda de Deberes</h2>
          <div class="bg-white p-4 rounded-lg shadow mb-6">
            <div class="flex justify-between items-center mb-4">
              <button id="previousWeek" class="bg-blue-500 text-white px-4 py-2 rounded">Semana Anterior</button>
              <h3 id="currentWeekDisplay" class="text-lg font-semibold">Semana Actual</h3>
              <button id="nextWeek" class="bg-blue-500 text-white px-4 py-2 rounded">Semana Siguiente</button>
              <button id="goToCurrentWeek" class="bg-green-500 text-white px-4 py-2 rounded">Ir a Hoy</button>
            </div>
            <div id="agendaContent"></div>
          </div>
          <button id="openReviewPanel" class="bg-purple-500 text-white px-4 py-2 rounded">Revisar Semanas Anteriores</button>
        </section>
      </main>

      <!-- Birthday Modal -->
      <div id="birthdayModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white p-8 rounded-lg shadow-lg max-w-md w-full mx-4">
          <h3 class="text-xl font-bold mb-4">¬°Feliz Cumplea√±os!</h3>
          <p id="birthdayMessage" class="mb-4"></p>
          <button onclick="closeBirthdayModal()" class="bg-blue-500 text-white px-4 py-2 rounded">Cerrar</button>
        </div>
      </div>

      <!-- Review Panel -->
      <div id="reviewPanel" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white p-8 rounded-lg shadow-lg max-w-4xl w-full mx-4 max-h-96 overflow-y-auto">
          <h3 class="text-xl font-bold mb-4">Revisar Semanas Anteriores</h3>
          <div id="reviewContent"></div>
          <button onclick="closeReviewPanel()" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded">Cerrar</button>
        </div>
      </div>

      <!-- Confetti Container -->
      <div id="confettiContainer" class="fixed inset-0 pointer-events-none z-40"></div>
      
      <!-- Offline Indicator -->
      <div id="offlineIndicator" class="offline-indicator">
        <i class="fas fa-wifi-slash"></i>
        Sin conexi√≥n - Funcionando en modo offline
      </div>
      
      <!-- PWA Install Prompt -->
      <div id="installPrompt" class="card">
        <div class="flex items-center justify-between">
          <div>
            <h4 class="font-semibold">Instalar App</h4>
            <p class="text-sm text-secondary">Instala la app para acceder m√°s r√°pido</p>
          </div>
          <div class="flex gap-2">
            <button id="installBtn" class="btn btn-primary">Instalar</button>
            <button id="dismissInstall" class="btn btn-secondary">Despu√©s</button>
          </div>
        </div>
      </div>
    </div>

    <script src="/app.js"></script>
  </body>
</html>
